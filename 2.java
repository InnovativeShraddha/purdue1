This is code from dev1
Again modified from dev1
